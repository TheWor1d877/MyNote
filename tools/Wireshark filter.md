Wireshark过滤器的核心是**精确筛选**，让你在海量数据包中只看你想看的。下面是其语法精髓和常用过滤器，按使用频率排序。

### 核心语法：两种过滤器
| 类型 | 用途 | 语法前缀 | 示例 |
| :--- | :--- | :--- | :--- |
| **捕获过滤器** | 在**抓包开始前**设定规则，只抓符合条件的数据包，**性能好**，但规则严格，可能漏包。 | 伯克利包过滤（BPF）语法，无需前缀。 | `host 192.168.1.1 and tcp port 80` |
| **显示过滤器** | 在**抓包后**过滤已捕获的数据包，**灵活强大**，最常用。 | 使用特定字段名和比较运算符，无前缀。 | `ip.addr == 192.168.1.1 and tcp.port == 80` |

**关键区别**：**显示过滤器是你99%时间会用的工具**，因为它允许你抓完包后反复、灵活地筛选。捕获过滤器仅在明确知道目标、且流量极大时使用。


### 最常用显示过滤器（立即可用）
下表按场景分类，涵盖了80%的日常需求：

| 过滤目标       | 常用过滤器                                                                   | 说明与示例                                                            |
| :--------- | :---------------------------------------------------------------------- | :--------------------------------------------------------------- |
| **协议过滤**   | `http` `dns` `arp` `icmp` `tcp` `udp`                                   | 只看某协议流量。例：`dns` 看所有DNS查询。                                        |
| **IP地址过滤** | `ip.addr == 192.168.1.1`<br>`ip.src == 10.0.0.1`<br>`ip.dst != 8.8.8.8` | 过滤特定IP。<br>`src`/`dst`区分源/目的。                                    |
| **端口过滤**   | `tcp.port == 443`<br>`udp.srcport == 53`<br>`tcp.dstport == 8080`       | 过滤特定端口。                                                          |
| **逻辑组合**   | `and` (与)、`or` (或)、`not` (非)、`in` (在集合内)                                | `http and ip.addr == 192.168.1.1`<br>`tcp.port in {80 443 8080}` |
| **存在性检查**  | `tcp.flags.syn`<br>`tcp.analysis.retransmission`                        | 过滤包含SYN标志或重传的包，用于诊断。                                             |

### 进阶实用技巧
1.  **自动补全**：在过滤器栏输入时，Wireshark会**自动提示字段名**，这是学习字段名的最佳方式。
2.  **右键“应用为过滤器”**：在数据包详情面板，对任何字段（如IP地址）**右键点击**，选择“作为过滤器应用” -> “选中”，过滤器会自动生成，极其方便。
3.  **比较操作符**：
    *   `==` (等于)、`!=` (不等于)
    *   `>`、`<`、`>=`、`<=` (常用于过滤包长度 `frame.len > 100`)
    *   `contains` (包含字符串)：`http.request.uri contains "login"`
    *   `matches` (正则匹配)：`http.host matches "\.(com|org)$"`

### 实战场景组合示例
结合你的学习目标，这些组合会非常有用：

| 你想观察什么                    | 推荐过滤器组合                                                                                                 |
| :------------------------ | :------------------------------------------------------------------------------------------------------ |
| **我的电脑与特定服务器的HTTP对话**     | `http and ip.addr == 服务器IP`                                                                             |
| **分析TCP连接建立过程（三次握手）**     | `tcp.flags.syn == 1 and tcp.flags.ack == 0` (只看SYN) <br> 或直接看流：`tcp.stream eq XX` (对某个包右键 > 追踪流 > TCP流) |
| **找出网络中的重传包（性能问题）**       | `tcp.analysis.retransmission`                                                                           |
| **只查看DNS查询和响应**           | `dns`                                                                                                   |
| **查看除ARP外的所有流量**          | `not arp`                                                                                               |
| **抓取与你的“北极星项目”服务器相关的所有包** | `tcp.port == 你的服务器端口` (例如 `tcp.port == 7878`)                                                           |
